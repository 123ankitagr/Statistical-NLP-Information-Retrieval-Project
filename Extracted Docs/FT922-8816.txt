Azerbaijan said it recaptured the town of Shusha in the Nagorno-Karabakh enclave but Armenia insisted its fighters still held the vital centre .