Actress Mia Farrow , involved in a bitter legal wrangle with ex-lover Woody Allen , won the custody case over three of the couple 's children .